CREATE TABLE availability_slots (end_time timestamp without time zone, id uuid NOT NULL DEFAULT gen_random_uuid(), tutor_id uuid NOT NULL DEFAULT gen_random_uuid(), start_time timestamp without time zone);
CREATE TABLE chat_messages (message text, attachment_id text, created_at timestamp without time zone, id uuid NOT NULL DEFAULT gen_random_uuid(), receiver_id uuid DEFAULT gen_random_uuid(), sender_id uuid NOT NULL DEFAULT gen_random_uuid());
CREATE TABLE lessons (meeting_link text, student_id uuid NOT NULL DEFAULT auth.uid(), tutor_id uuid DEFAULT auth.uid(), start_time timestamp without time zone, end_time timestamp without time zone, duration bigint, created_at timestamp without time zone, subject_id text, status text DEFAULT 'scheduled, confirmed, completed, cancelled'::text, id uuid NOT NULL DEFAULT auth.uid());
CREATE TABLE payments (lesson_id uuid NOT NULL DEFAULT gen_random_uuid(), id uuid NOT NULL DEFAULT gen_random_uuid(), created_at timestamp without time zone, comission double precision, amount double precision, status text DEFAULT 'pending, completed, refunded'::text, external_id text, payment_method text);
CREATE TABLE reviews (rating bigint, id uuid NOT NULL DEFAULT gen_random_uuid(), author_id uuid NOT NULL DEFAULT gen_random_uuid(), target_id uuid DEFAULT gen_random_uuid(), lesson_id uuid DEFAULT gen_random_uuid(), created_at timestamp without time zone, comment text);
CREATE TABLE users (blocked boolean DEFAULT false, email text NOT NULL DEFAULT ''::text, password text NOT NULL, name text, role text NOT NULL DEFAULT 'student, tutor, admin'::text, languages ARRAY, level text, id uuid NOT NULL DEFAULT gen_random_uuid(), telegram text, avatar_url text, created_at timestamp without time zone NOT NULL DEFAULT '2025-07-20 00:56:29.888129'::timestamp without time zone, kyc_status text, is_verified boolean, rating double precision, last_active_at timestamp without time zone);
